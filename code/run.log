nohup: 忽略输入
eval_score_matrix_foldout with cpp
[0;30;43m
██████╗ ███████╗ ██████╗███████╗██████╗  █████╗ ███████╗███████╗██████╗ 
██╔══██╗██╔════╝██╔════╝██╔════╝██╔══██╗██╔══██╗██╔════╝██╔════╝██╔══██╗
██████╔╝█████╗  ██║     █████╗  ██████╔╝███████║███████╗█████╗  ██████╔╝
██╔══██╗██╔══╝  ██║     ██╔══╝  ██╔══██╗██╔══██║╚════██║██╔══╝  ██╔══██╗
██║  ██║███████╗╚██████╗███████╗██║  ██║██║  ██║███████║███████╗██║  ██║
╚═╝  ╚═╝╚══════╝ ╚═════╝╚══════╝╚═╝  ╚═╝╚═╝  ╚═╝╚══════╝╚══════╝╚═╝  ╚═╝
[0m
{'模型配置&&数据集配置': {'model_name': 'RecEraser',
                 'dataset_name': 'ml-1m',
                 'dataloader_name': 'spilit'},
 '路径配置': {'root_path': '/mnt/WangchengTao/code/hkuds/RecEraser-PyTorch',
          'code_path': '/mnt/WangchengTao/code/hkuds/RecEraser-PyTorch/code',
          'data_path': '/mnt/WangchengTao/code/hkuds/RecEraser-PyTorch/data',
          'dataset_path': '/mnt/WangchengTao/code/hkuds/RecEraser-PyTorch/data/ml-1m',
          'tensorboard_path': '/mnt/WangchengTao/code/hkuds/RecEraser-PyTorch/code/runs',
          'weights_path': '/mnt/WangchengTao/code/hkuds/RecEraser-PyTorch/code/checkpoints'},
 '超参数配置': {'epochs': 1,
           'topks': [10, 20, 50],
           'embedding_size': 64,
           'train_batch_size': 1024,
           'test_batch_size': 1024,
           'layers': 3,
           'lr': 0.001,
           'decay': 0.001,
           'dropout': False,
           'keep_prob': 0.6},
 '划分配置': {'data_partition': True,
          'partition_method': 'interaction_based',
          'num_shards': 10,
          'max_iters': 1,
          'attention_size': 32,
          'attention_epochs': 1,
          'partition_path': '/mnt/WangchengTao/code/hkuds/RecEraser-PyTorch/data/ml-1m/interaction_based',
          'shards_path': '/mnt/WangchengTao/code/hkuds/RecEraser-PyTorch/data/ml-1m/interaction_based/num_10',
          'temp': 0.5},
 '设备配置': {'device': device(type='cuda'), 'seed': 2020},
 '其它配置': {'a_hat_split': False,
          'a_hat_folds': 100,
          'multicore': False,
          'pretrain': False,
          'weight_filename': '/mnt/WangchengTao/code/hkuds/RecEraser-PyTorch/code/checkpoints/RecEraser-ml-1m-3-64.pth',
          'tensorboard': False,
          'tensorboard_writer': None,
          'verbose': 1}}
[0;30;43mnot enable tensorflowboard[0m
>>SEED: 2020
[0;30;43mloading [/mnt/WangchengTao/code/hkuds/RecEraser-PyTorch/data/ml-1m][0m
[0;30;43mloading adjacency matrix[0m
don't split the matrix
[0;30;43mcosting 1.8352251052856445s, loaded norm_mat...[0m
720152 interactions for training
200041 interactions for testing
ml-1m Sparsity : 0.04110896773801567
ml-1m is ready to go
[0;30;43mloading adjacency matrix[0m
[0;30;43mcosting 0.2548367977142334s, loaded norm_mat...[0m
training nums of each local data:
[86418, 86418, 17734, 86418, 86418, 86418, 11074, 86418, 86418, 86418]
[0;30;43mn_users:6040[0m
[0;30;43mm_items:3706[0m
[0;30;43minit_users_embeddings:torch.Size([6040, 64])[0m
[0;30;43minit_items_embeddings:torch.Size([3706, 64])[0m
[86418, 86418, 86418, 86418, 1286, 86418, 64302, 81043, 55013, 86418]
0 19.948772847652435
/mnt/WangchengTao/code/hkuds/RecEraser-PyTorch/code/dataloaders.py:231: RuntimeWarning: divide by zero encountered in power
  d_inv = np.power(rowsum, -0.5).flatten()  # 因为有的行没有数据所以会有除以0的问题存在
第 0 个batch
第 1 个batch
第 2 个batch
第 3 个batch
第 4 个batch
第 5 个batch
第 6 个batch
第 7 个batch
第 8 个batch
第 9 个batch
第 10 个batch
第 11 个batch
第 12 个batch
第 13 个batch
第 14 个batch
第 15 个batch
第 16 个batch
第 17 个batch
第 18 个batch
第 19 个batch
第 20 个batch
第 21 个batch
第 22 个batch
第 23 个batch
第 24 个batch
第 25 个batch
第 26 个batch
第 27 个batch
第 28 个batch
第 29 个batch
第 30 个batch
第 31 个batch
第 32 个batch
第 33 个batch
第 34 个batch
第 35 个batch
第 36 个batch
第 37 个batch
第 38 个batch
第 39 个batch
第 40 个batch
第 41 个batch
第 42 个batch
第 43 个batch
第 44 个batch
第 45 个batch
第 46 个batch
第 47 个batch
第 48 个batch
第 49 个batch
第 50 个batch
第 51 个batch
第 52 个batch
第 53 个batch
第 54 个batch
第 55 个batch
第 56 个batch
第 57 个batch
第 58 个batch
第 59 个batch
第 60 个batch
第 61 个batch
第 62 个batch
第 63 个batch
第 64 个batch
第 65 个batch
第 66 个batch
第 67 个batch
第 68 个batch
第 69 个batch
第 70 个batch
第 71 个batch
第 72 个batch
第 73 个batch
第 74 个batch
第 75 个batch
第 76 个batch
第 77 个batch
第 78 个batch
第 79 个batch
第 80 个batch
第 81 个batch
第 82 个batch
第 83 个batch
第 84 个batch
第 85 个batch
第 86 个batch
第 87 个batch
第 88 个batch
第 89 个batch
第 90 个batch
第 91 个batch
第 92 个batch
第 93 个batch
第 94 个batch
第 95 个batch
第 96 个batch
第 97 个batch
第 98 个batch
第 99 个batch
第 100 个batch
第 101 个batch
第 102 个batch
第 103 个batch
第 104 个batch
第 105 个batch
第 106 个batch
第 107 个batch
第 108 个batch
第 109 个batch
第 110 个batch
第 111 个batch
第 112 个batch
第 113 个batch
第 114 个batch
第 115 个batch
第 116 个batch
第 117 个batch
第 118 个batch
第 119 个batch
第 120 个batch
第 121 个batch
第 122 个batch
第 123 个batch
第 124 个batch
第 125 个batch
第 126 个batch
第 127 个batch
第 128 个batch
第 129 个batch
第 130 个batch
第 131 个batch
第 132 个batch
第 133 个batch
第 134 个batch
第 135 个batch
第 136 个batch
第 137 个batch
第 138 个batch
第 139 个batch
第 140 个batch
第 141 个batch
第 142 个batch
第 143 个batch
第 144 个batch
第 145 个batch
第 146 个batch
第 147 个batch
第 148 个batch
第 149 个batch
第 150 个batch
第 151 个batch
第 152 个batch
第 153 个batch
第 154 个batch
第 155 个batch
第 156 个batch
第 157 个batch
第 158 个batch
第 159 个batch
第 160 个batch
第 161 个batch
第 162 个batch
第 163 个batch
第 164 个batch
第 165 个batch
第 166 个batch
第 167 个batch
第 168 个batch
第 169 个batch
第 170 个batch
第 171 个batch
第 172 个batch
第 173 个batch
第 174 个batch
第 175 个batch
第 176 个batch
第 177 个batch
第 178 个batch
第 179 个batch
第 180 个batch
第 181 个batch
第 182 个batch
第 183 个batch
第 184 个batch
第 185 个batch
第 186 个batch
第 187 个batch
第 188 个batch
第 189 个batch
第 190 个batch
第 191 个batch
第 192 个batch
第 193 个batch
第 194 个batch
第 195 个batch
第 196 个batch
第 197 个batch
第 198 个batch
第 199 个batch
第 200 个batch
第 201 个batch
第 202 个batch
第 203 个batch
第 204 个batch
第 205 个batch
第 206 个batch
第 207 个batch
第 208 个batch
第 209 个batch
第 210 个batch
第 211 个batch
第 212 个batch
第 213 个batch
第 214 个batch
第 215 个batch
第 216 个batch
第 217 个batch
第 218 个batch
第 219 个batch
第 220 个batch
第 221 个batch
第 222 个batch
第 223 个batch
第 224 个batch
第 225 个batch
第 226 个batch
第 227 个batch
第 228 个batch
第 229 个batch
第 230 个batch
第 231 个batch
第 232 个batch
第 233 个batch
第 234 个batch
第 235 个batch
第 236 个batch
第 237 个batch
第 238 个batch
第 239 个batch
第 240 个batch
第 241 个batch
第 242 个batch
第 243 个batch
第 244 个batch
第 245 个batch
第 246 个batch
第 247 个batch
第 248 个batch
第 249 个batch
第 250 个batch
第 251 个batch
第 252 个batch
第 253 个batch
第 254 个batch
第 255 个batch
第 256 个batch
第 257 个batch
第 258 个batch
第 259 个batch
第 260 个batch
第 261 个batch
第 262 个batch
第 263 个batch
第 264 个batch
第 265 个batch
第 266 个batch
第 267 个batch
第 268 个batch
第 269 个batch
第 270 个batch
第 271 个batch
第 272 个batch
第 273 个batch
第 274 个batch
第 275 个batch
第 276 个batch
第 277 个batch
第 278 个batch
第 279 个batch
第 280 个batch
第 281 个batch
第 282 个batch
第 283 个batch
第 284 个batch
第 285 个batch
第 286 个batch
第 287 个batch
第 288 个batch
第 289 个batch
第 290 个batch
第 291 个batch
第 292 个batch
第 293 个batch
第 294 个batch
第 295 个batch
第 296 个batch
第 297 个batch
第 298 个batch
第 299 个batch
第 300 个batch
第 301 个batch
第 302 个batch
第 303 个batch
第 304 个batch
第 305 个batch
第 306 个batch
第 307 个batch
第 308 个batch
第 309 个batch
第 310 个batch
第 311 个batch
第 312 个batch
第 313 个batch
第 314 个batch
第 315 个batch
第 316 个batch
第 317 个batch
第 318 个batch
第 319 个batch
第 320 个batch
第 321 个batch
第 322 个batch
第 323 个batch
第 324 个batch
第 325 个batch
第 326 个batch
第 327 个batch
第 328 个batch
第 329 个batch
第 330 个batch
第 331 个batch
第 332 个batch
第 333 个batch
第 334 个batch
第 335 个batch
第 336 个batch
第 337 个batch
第 338 个batch
第 339 个batch
第 340 个batch
第 341 个batch
第 342 个batch
第 343 个batch
第 344 个batch
第 345 个batch
第 346 个batch
第 347 个batch
第 348 个batch
第 349 个batch
第 350 个batch
第 351 个batch
第 352 个batch
第 353 个batch
第 354 个batch
第 355 个batch
第 356 个batch
第 357 个batch
第 358 个batch
第 359 个batch
第 360 个batch
第 361 个batch
第 362 个batch
第 363 个batch
第 364 个batch
第 365 个batch
第 366 个batch
第 367 个batch
第 368 个batch
第 369 个batch
第 370 个batch
第 371 个batch
第 372 个batch
第 373 个batch
第 374 个batch
第 375 个batch
第 376 个batch
第 377 个batch
第 378 个batch
第 379 个batch
第 380 个batch
第 381 个batch
第 382 个batch
第 383 个batch
第 384 个batch
第 385 个batch
第 386 个batch
第 387 个batch
第 388 个batch
第 389 个batch
第 390 个batch
第 391 个batch
第 392 个batch
第 393 个batch
第 394 个batch
第 395 个batch
第 396 个batch
第 397 个batch
第 398 个batch
第 399 个batch
第 400 个batch
第 401 个batch
第 402 个batch
第 403 个batch
第 404 个batch
第 405 个batch
第 406 个batch
第 407 个batch
第 408 个batch
第 409 个batch
第 410 个batch
第 411 个batch
第 412 个batch
第 413 个batch
第 414 个batch
第 415 个batch
第 416 个batch
第 417 个batch
第 418 个batch
第 419 个batch
第 420 个batch
第 421 个batch
第 422 个batch
第 423 个batch
第 424 个batch
第 425 个batch
第 426 个batch
第 427 个batch
第 428 个batch
第 429 个batch
第 430 个batch
第 431 个batch
第 432 个batch
第 433 个batch
第 434 个batch
第 435 个batch
第 436 个batch
第 437 个batch
第 438 个batch
第 439 个batch
第 440 个batch
第 441 个batch
第 442 个batch
第 443 个batch
第 444 个batch
第 445 个batch
第 446 个batch
第 447 个batch
第 448 个batch
第 449 个batch
第 450 个batch
第 451 个batch
第 452 个batch
第 453 个batch
第 454 个batch
第 455 个batch
第 456 个batch
第 457 个batch
第 458 个batch
第 459 个batch
第 460 个batch
第 461 个batch
第 462 个batch
第 463 个batch
第 464 个batch
第 465 个batch
第 466 个batch
第 467 个batch
第 468 个batch
第 469 个batch
第 470 个batch
第 471 个batch
第 472 个batch
第 473 个batch
第 474 个batch
第 475 个batch
第 476 个batch
第 477 个batch
第 478 个batch
第 479 个batch
第 480 个batch
第 481 个batch
第 482 个batch
第 483 个batch
第 484 个batch
第 485 个batch
第 486 个batch
第 487 个batch
第 488 个batch
第 489 个batch
第 490 个batch
第 491 个batch
第 492 个batch
第 493 个batch
第 494 个batch
第 495 个batch
第 496 个batch
第 497 个batch
第 498 个batch
第 499 个batch
第 500 个batch
第 501 个batch
第 502 个batch
第 503 个batch
第 504 个batch
第 505 个batch
第 506 个batch
第 507 个batch
第 508 个batch
第 509 个batch
第 510 个batch
第 511 个batch
第 512 个batch
第 513 个batch
第 514 个batch
第 515 个batch
第 516 个batch
第 517 个batch
第 518 个batch
第 519 个batch
第 520 个batch
第 521 个batch
第 522 个batch
第 523 个batch
第 524 个batch
第 525 个batch
第 526 个batch
第 527 个batch
第 528 个batch
第 529 个batch
第 530 个batch
第 531 个batch
第 532 个batch
第 533 个batch
第 534 个batch
第 535 个batch
第 536 个batch
第 537 个batch
第 538 个batch
第 539 个batch
第 540 个batch
第 541 个batch
第 542 个batch
第 543 个batch
第 544 个batch
第 545 个batch
第 546 个batch
第 547 个batch
第 548 个batch
第 549 个batch
第 550 个batch
第 551 个batch
第 552 个batch
第 553 个batch
第 554 个batch
第 555 个batch
第 556 个batch
第 557 个batch
第 558 个batch
第 559 个batch
第 560 个batch
第 561 个batch
第 562 个batch
第 563 个batch
第 564 个batch
第 565 个batch
第 566 个batch
第 567 个batch
第 568 个batch
第 569 个batch
第 570 个batch
第 571 个batch
第 572 个batch
第 573 个batch
第 574 个batch
第 575 个batch
第 576 个batch
第 577 个batch
第 578 个batch
第 579 个batch
第 580 个batch
第 581 个batch
第 582 个batch
第 583 个batch
第 584 个batch
第 585 个batch
第 586 个batch
第 587 个batch
第 588 个batch
第 589 个batch
第 590 个batch
第 591 个batch
第 592 个batch
第 593 个batch
第 594 个batch
第 595 个batch
第 596 个batch
第 597 个batch
第 598 个batch
第 599 个batch
第 600 个batch
第 601 个batch
第 602 个batch
第 603 个batch
第 604 个batch
第 605 个batch
第 606 个batch
第 607 个batch
第 608 个batch
第 609 个batch
第 610 个batch
第 611 个batch
第 612 个batch
第 613 个batch
第 614 个batch
第 615 个batch
第 616 个batch
第 617 个batch
第 618 个batch
第 619 个batch
第 620 个batch
第 621 个batch
第 622 个batch
第 623 个batch
第 624 个batch
第 625 个batch
第 626 个batch
第 627 个batch
第 628 个batch
第 629 个batch
第 630 个batch
第 631 个batch
第 632 个batch
第 633 个batch
第 634 个batch
第 635 个batch
第 636 个batch
第 637 个batch
第 638 个batch
第 639 个batch
第 640 个batch
第 641 个batch
第 642 个batch
第 643 个batch
第 644 个batch
第 645 个batch
第 646 个batch
第 647 个batch
第 648 个batch
第 649 个batch
第 650 个batch
第 651 个batch
第 652 个batch
第 653 个batch
第 654 个batch
第 655 个batch
第 656 个batch
第 657 个batch
第 658 个batch
第 659 个batch
第 660 个batch
第 661 个batch
第 662 个batch
第 663 个batch
第 664 个batch
第 665 个batch
第 666 个batch
第 667 个batch
第 668 个batch
第 669 个batch
第 670 个batch
第 671 个batch
第 672 个batch
第 673 个batch
第 674 个batch
第 675 个batch
第 676 个batch
第 677 个batch
第 678 个batch
第 679 个batch
第 680 个batch
第 681 个batch
第 682 个batch
第 683 个batch
第 684 个batch
第 685 个batch
第 686 个batch
第 687 个batch
第 688 个batch
第 689 个batch
第 690 个batch
第 691 个batch
第 692 个batch
第 693 个batch
第 694 个batch
第 695 个batch
第 696 个batch
第 697 个batch
第 698 个batch
第 699 个batch
第 700 个batch
第 701 个batch
第 702 个batch
第 703 个batch
CL_MODEL: EPOCH[1/1] lossnan-time2050.202s
/mnt/WangchengTao/tools/anaconda3/envs/hkuds/lib/python3.9/site-packages/numpy/core/fromnumeric.py:3474: RuntimeWarning: Mean of empty slice.
  return _methods._mean(a, axis=axis, dtype=dtype,
/mnt/WangchengTao/tools/anaconda3/envs/hkuds/lib/python3.9/site-packages/numpy/core/_methods.py:189: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
[86418, 86418, 86418, 86418, 86418, 86418, 86418, 86418, 28808, 0]
0 nan
training nums of each local data:
[86418, 86418, 86418, 86418, 86418, 86418, 86418, 86418, 28808, 0]
LightGCN is already to go(dropout:False)
LightGCN is already to go(dropout:False)
LightGCN is already to go(dropout:False)
LightGCN is already to go(dropout:False)
LightGCN is already to go(dropout:False)
LightGCN is already to go(dropout:False)
LightGCN is already to go(dropout:False)
LightGCN is already to go(dropout:False)
LightGCN is already to go(dropout:False)
LightGCN is already to go(dropout:False)
[0;30;43muse initilizer[0m
RecEraserLightGCN is already to go(dropout:False)
linears.0.weight torch.Size([64, 64])
linears.0.bias torch.Size([64])
linears.1.weight torch.Size([64, 64])
linears.1.bias torch.Size([64])
linears.2.weight torch.Size([64, 64])
linears.2.bias torch.Size([64])
linears.3.weight torch.Size([64, 64])
linears.3.bias torch.Size([64])
linears.4.weight torch.Size([64, 64])
linears.4.bias torch.Size([64])
linears.5.weight torch.Size([64, 64])
linears.5.bias torch.Size([64])
linears.6.weight torch.Size([64, 64])
linears.6.bias torch.Size([64])
linears.7.weight torch.Size([64, 64])
linears.7.bias torch.Size([64])
linears.8.weight torch.Size([64, 64])
linears.8.bias torch.Size([64])
linears.9.weight torch.Size([64, 64])
linears.9.bias torch.Size([64])
W_b_user.weight torch.Size([32, 64])
W_b_user.bias torch.Size([32])
H_user.weight torch.Size([1, 32])
W_b_item.weight torch.Size([32, 64])
W_b_item.bias torch.Size([32])
H_item.weight torch.Size([1, 32])
load and save to /mnt/WangchengTao/code/hkuds/RecEraser-PyTorch/code/checkpoints/RecEraser-ml-1m-3-64.pth
[0;30;43mshard 0 start training and testing[0m
id_model[0/10] EPOCH[1/1] loss0.679-time3.243s
[Valid] {'precision': array([0.02436974, 0.02121025, 0.0173107 ]), 'recall': array([0.01887042, 0.03179542, 0.06211511]), 'ndcg': array([0.02970339, 0.03209765, 0.04131177])}
[0;30;43msave model to /mnt/WangchengTao/code/hkuds/RecEraser-PyTorch/code/checkpoints/RecEraser-ml-1m-3-64id_[None-10].pth[0m
[Test] {'precision': array([0.02410367, 0.02182313, 0.01703392]), 'recall': array([0.01870747, 0.03205337, 0.05997813]), 'ndcg': array([0.0291324 , 0.03205048, 0.04031735])}
[0;30;43mshard 1 start training and testing[0m
id_model[1/10] EPOCH[1/1] loss0.684-time3.418s
[Valid] {'precision': array([0.02084019, 0.01857999, 0.015341  ]), 'recall': array([0.01556029, 0.02668118, 0.05386551]), 'ndcg': array([0.02485547, 0.02698779, 0.03515883])}
[0;30;43msave model to /mnt/WangchengTao/code/hkuds/RecEraser-PyTorch/code/checkpoints/RecEraser-ml-1m-3-64id_[None-10].pth[0m
[Test] {'precision': array([0.0215282 , 0.0188017 , 0.01561335]), 'recall': array([0.01655983, 0.02718824, 0.05359055]), 'ndcg': array([0.02615724, 0.02775539, 0.03568201])}
[0;30;43mshard 2 start training and testing[0m
id_model[2/10] EPOCH[1/1] loss0.682-time3.446s
[Valid] {'precision': array([0.02210072, 0.01945397, 0.01545866]), 'recall': array([0.01641024, 0.02754332, 0.05213857]), 'ndcg': array([0.02677226, 0.0286858 , 0.03588066])}
[0;30;43msave model to /mnt/WangchengTao/code/hkuds/RecEraser-PyTorch/code/checkpoints/RecEraser-ml-1m-3-64id_[None-10].pth[0m
[Test] {'precision': array([0.02238671, 0.01919727, 0.01553591]), 'recall': array([0.01637939, 0.02661958, 0.05233312]), 'ndcg': array([0.02772556, 0.02878736, 0.0362898 ])}
[0;30;43mshard 3 start training and testing[0m
id_model[3/10] EPOCH[1/1] loss0.683-time3.123s
[Valid] {'precision': array([0.02529415, 0.02200022, 0.01746866]), 'recall': array([0.02168962, 0.03534507, 0.06476814]), 'ndcg': array([0.03057387, 0.03330946, 0.0425143 ])}
[0;30;43msave model to /mnt/WangchengTao/code/hkuds/RecEraser-PyTorch/code/checkpoints/RecEraser-ml-1m-3-64id_[None-10].pth[0m
[Test] {'precision': array([0.02514729, 0.02150332, 0.01695986]), 'recall': array([0.01998301, 0.03299721, 0.06241369]), 'ndcg': array([0.02988753, 0.03176694, 0.04054751])}
[0;30;43mshard 4 start training and testing[0m
id_model[4/10] EPOCH[1/1] loss0.683-time3.359s
[Valid] {'precision': array([0.02240326, 0.01995816, 0.01610062]), 'recall': array([0.01575429, 0.02736173, 0.05558887]), 'ndcg': array([0.02590735, 0.02815571, 0.03653885])}
[0;30;43msave model to /mnt/WangchengTao/code/hkuds/RecEraser-PyTorch/code/checkpoints/RecEraser-ml-1m-3-64id_[None-10].pth[0m
[Test] {'precision': array([0.02215104, 0.01986213, 0.01596344]), 'recall': array([0.01654994, 0.03005317, 0.05585208]), 'ndcg': array([0.02581079, 0.02850549, 0.036288  ])}
[0;30;43mshard 5 start training and testing[0m
id_model[5/10] EPOCH[1/1] loss0.682-time3.451s
[Valid] {'precision': array([0.02215116, 0.01923545, 0.01583509]), 'recall': array([0.0152129 , 0.02581833, 0.05182393]), 'ndcg': array([0.02557857, 0.02706178, 0.03483352])}
[0;30;43msave model to /mnt/WangchengTao/code/hkuds/RecEraser-PyTorch/code/checkpoints/RecEraser-ml-1m-3-64id_[None-10].pth[0m
[Test] {'precision': array([0.0223867 , 0.01934034, 0.01591967]), 'recall': array([0.01575249, 0.0260814 , 0.05235164]), 'ndcg': array([0.02646261, 0.02766242, 0.03537343])}
[0;30;43mshard 6 start training and testing[0m
id_model[6/10] EPOCH[1/1] loss0.685-time3.310s
[Valid] {'precision': array([0.02151245, 0.01915983, 0.01552585]), 'recall': array([0.01596096, 0.02724187, 0.05376697]), 'ndcg': array([0.02544962, 0.0274972 , 0.03544351])}
[0;30;43msave model to /mnt/WangchengTao/code/hkuds/RecEraser-PyTorch/code/checkpoints/RecEraser-ml-1m-3-64id_[None-10].pth[0m
[Test] {'precision': array([0.02199955, 0.01926462, 0.01568066]), 'recall': array([0.01508233, 0.02685827, 0.05168726]), 'ndcg': array([0.02510825, 0.02699655, 0.03439846])}
[0;30;43mshard 7 start training and testing[0m
id_model[7/10] EPOCH[1/1] loss0.680-time3.317s
[Valid] {'precision': array([0.02442016, 0.02171449, 0.01751573]), 'recall': array([0.01823826, 0.03146812, 0.06087259]), 'ndcg': array([0.02806122, 0.03073143, 0.03981735])}
[0;30;43msave model to /mnt/WangchengTao/code/hkuds/RecEraser-PyTorch/code/checkpoints/RecEraser-ml-1m-3-64id_[None-10].pth[0m
[Test] {'precision': array([0.0253156 , 0.0220083 , 0.01728305]), 'recall': array([0.01899041, 0.03101062, 0.05979278]), 'ndcg': array([0.02986844, 0.03178297, 0.04033548])}
[0;30;43mshard 8 start training and testing[0m
id_model[8/10] EPOCH[1/1] loss0.691-time1.066s
[Valid] {'precision': array([0.00806721, 0.00746214, 0.00700513]), 'recall': array([0.00508788, 0.00906552, 0.02085177]), 'ndcg': array([0.00933111, 0.0100994 , 0.01392806])}
[0;30;43msave model to /mnt/WangchengTao/code/hkuds/RecEraser-PyTorch/code/checkpoints/RecEraser-ml-1m-3-64id_[None-10].pth[0m
[Test] {'precision': array([0.00882003, 0.00785216, 0.00699218]), 'recall': array([0.00570189, 0.00991537, 0.02092004]), 'ndcg': array([0.00975709, 0.010458  , 0.01404389])}
[0;30;43mshard 9 start training and testing[0m
Traceback (most recent call last):
  File "/mnt/WangchengTao/code/hkuds/RecEraser-PyTorch/code/main.py", line 74, in <module>
    model.train_test(dataloader)
  File "/mnt/WangchengTao/code/hkuds/RecEraser-PyTorch/code/models.py", line 584, in train_test
    sub_model.train_test(dataloader.sub_dataloaders[id_shard])
  File "/mnt/WangchengTao/code/hkuds/RecEraser-PyTorch/code/models.py", line 473, in train_test
    self.train_test2(dataloader)
  File "/mnt/WangchengTao/code/hkuds/RecEraser-PyTorch/code/models.py", line 215, in train_test2
    users, pos_items, neg_items = sample()
  File "/mnt/WangchengTao/code/hkuds/RecEraser-PyTorch/code/dataloaders.py", line 76, in sample2
    users = [random.choice(self.alive_users) for _ in range(self.train_batch_size)]
  File "/mnt/WangchengTao/code/hkuds/RecEraser-PyTorch/code/dataloaders.py", line 76, in <listcomp>
    users = [random.choice(self.alive_users) for _ in range(self.train_batch_size)]
  File "/mnt/WangchengTao/tools/anaconda3/envs/hkuds/lib/python3.9/random.py", line 346, in choice
    return seq[self._randbelow(len(seq))]
IndexError: list index out of range
